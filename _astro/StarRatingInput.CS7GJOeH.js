import{j as t}from"./jsx-runtime.CyXy1Ci3.js";import{r as s}from"./index.CaZlGE7t.js";function y({initialRating:n,reviewSlug:d,totalStars:h=5,readOnly:a=!1}){const[S,l]=s.useState(n||0),[j,m]=s.useState(0),[u,x]=s.useState(!1),[p,o]=s.useState(""),[f,r]=s.useState("");s.useEffect(()=>{l(n||0)},[n]);const k=async e=>{if(!(a||u)){x(!0),o(""),r("");try{const i=await fetch("/api/rate.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({slug:d,rating:e})}),c=await i.json();i.ok?(l(c.newAverageRating||e),o(c.message||"Įvertinimas išsaugotas sėkmingai!")):r(c.message||"Nepavyko išsaugoti įvertinimo.")}catch(i){r("Įvyko tinklo klaida. Bandykite dar kartą."),console.error("Rating submission error:",i)}finally{x(!1),setTimeout(()=>{o(""),r("")},3e3)}}},g=[];for(let e=1;e<=h;e++)g.push(t.jsx("span",{className:`cursor-pointer text-2xl transition-colors duration-150 ${e<=(j||S)?"text-yellow-500":"text-gray-400"} ${a?"cursor-default":""}`,onMouseEnter:()=>!a&&m(e),onMouseLeave:()=>!a&&m(0),onClick:()=>k(e),children:t.jsx("i",{className:"fa-solid fa-star"})},e));return t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("div",{className:"flex items-center space-x-1",children:g}),u&&t.jsx("p",{className:"text-blue-500 text-sm mt-2",children:"Siunčiama..."}),p&&t.jsx("p",{className:"text-green-500 text-sm mt-2",children:p}),f&&t.jsx("p",{className:"text-red-500 text-sm mt-2",children:f}),!a&&t.jsx("p",{className:"text-gray-600 text-xs mt-2",children:"Spustelėkite, kad įvertintumėte!"})]})}export{y as default};
