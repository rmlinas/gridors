const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["_astro/index.s-9Luwnv.js","_astro/index.CaZlGE7t.js","_astro/chart.BtZhsaeM.js"])))=>i.map(i=>d[i]);
import{j as e}from"./jsx-runtime.CyXy1Ci3.js";import{r as v}from"./index.CaZlGE7t.js";const B="modulepreload",M=function(s){return"/"+s},A={},W=function(a,l,c){let d=Promise.resolve();if(l&&l.length>0){let t=function(p){return Promise.all(p.map(r=>Promise.resolve(r).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),x=i?.nonce||i?.getAttribute("nonce");d=t(l.map(p=>{if(p=M(p),p in A)return;A[p]=!0;const r=p.endsWith(".css"),m=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${m}`))return;const u=document.createElement("link");if(u.rel=r?"stylesheet":B,r||(u.as="script"),u.crossOrigin="",u.href=p,x&&u.setAttribute("nonce",x),document.head.appendChild(u),r)return new Promise((y,b)=>{u.addEventListener("load",y),u.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${p}`)))})}))}function n(t){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=t,window.dispatchEvent(i),!i.defaultPrevented)throw t}return d.then(t=>{for(const i of t||[])i.status==="rejected"&&n(i.reason);return a().catch(n)})},V=({appliances:s,updateAppliance:a,removeAppliance:l,newAppliance:c,setNewAppliance:d,addAppliance:n})=>e.jsxs("div",{className:"mb-8 p-6 border border-gray-200 rounded-lg bg-gray-50",children:[e.jsx("h3",{className:"text-2xl font-semibold text-gray-800 mb-4 section-title",children:"1. Your Appliance Load"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"List all appliances you plan to power and their estimated daily usage."}),e.jsx("div",{className:"space-y-4 mb-6",children:s.map(t=>e.jsx("div",{className:"p-3 bg-white rounded-md shadow-sm border border-gray-100",children:e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-6 lg:grid-cols-7 xl:grid-cols-8 gap-x-4 gap-y-2 items-end",children:[e.jsxs("label",{className:"flex flex-col col-span-full sm:col-span-2",children:[e.jsx("span",{className:"text-gray-700 text-sm mb-1",children:"Appliance Name"}),e.jsx("input",{type:"text",value:t.name,onChange:i=>a(t.id,"name",i.target.value),placeholder:"Name",className:"p-2 border border-gray-300 rounded-md focus:ring-gridors-primary focus:border-gridors-primary"})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"text-gray-700 text-sm mb-1",children:"Rated Watts"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",value:t.watts,onChange:i=>a(t.id,"watts",i.target.value),placeholder:"W",className:"p-2 border border-gray-300 rounded-md focus:ring-gridors-primary focus:border-gridors-primary pr-8 w-full"}),e.jsx("span",{className:"absolute inset-y-0 right-0 pr-2 flex items-center text-gray-600 pointer-events-none",children:"W"})]})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"text-gray-700 text-sm mb-1",children:"Surge Watts"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",value:t.surgeWatts!==void 0?t.surgeWatts:"",onChange:i=>a(t.id,"surgeWatts",i.target.value),placeholder:"W",className:"p-2 border border-gray-300 rounded-md focus:ring-gridors-primary focus:border-gridors-primary pr-8 w-full",title:"Peak power drawn momentarily on startup"}),e.jsx("span",{className:"absolute inset-y-0 right-0 pr-2 flex items-center text-gray-600 pointer-events-none",children:"W"})]})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"text-gray-700 text-sm mb-1",children:"Hours/day"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",value:t.hours,onChange:i=>a(t.id,"hours",i.target.value),placeholder:"Hrs",className:"p-2 border border-gray-300 rounded-md focus:ring-gridors-primary focus:border-gridors-primary pr-8 w-full"}),e.jsx("span",{className:"absolute inset-y-0 right-0 pr-2 flex items-center text-gray-600 pointer-events-none",children:"Hrs"})]})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"text-gray-700 text-sm mb-1",children:"Duty Cycle (0-1)"}),e.jsx("input",{type:"number",value:t.dutyCycle!==void 0?t.dutyCycle:"",onChange:i=>a(t.id,"dutyCycle",i.target.value),placeholder:"e.g., 0.33",step:"0.01",className:"p-2 border border-gray-300 rounded-md text-sm focus:ring-gridors-primary focus:border-gridors-primary w-full",title:"For compressor-based appliances like fridges"})]}),e.jsx("div",{className:"flex justify-end items-end col-span-full sm:col-span-1",children:e.jsx("button",{onClick:()=>l(t.id),className:"p-2 bg-red-500 text-white rounded-md hover:bg-red-600 transition-colors",children:e.jsx("i",{className:"fas fa-trash-alt"})})})]})},t.id))}),e.jsx("div",{className:"p-3 bg-white rounded-md shadow-sm border border-gray-100",children:e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-6 lg:grid-cols-7 xl:grid-cols-8 gap-x-4 gap-y-2 items-end",children:[e.jsxs("label",{className:"flex flex-col col-span-full sm:col-span-2",children:[e.jsx("span",{className:"text-gray-700 text-sm mb-1",children:"New Appliance Name"}),e.jsx("input",{type:"text",value:c.name,onChange:t=>d({...c,name:t.target.value}),placeholder:"Name",className:"p-2 border border-gray-300 rounded-md focus:ring-gridors-primary focus:border-gridors-primary"})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"text-gray-700 text-sm mb-1",children:"Rated Watts (W)"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",value:c.watts,onChange:t=>d({...c,watts:t.target.value}),placeholder:"W",className:"p-2 border border-gray-300 rounded-md focus:ring-gridors-primary focus:border-gridors-primary pr-8 w-full"}),e.jsx("span",{className:"absolute inset-y-0 right-0 pr-2 flex items-center text-gray-600 pointer-events-none",children:"W"})]})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"text-gray-700 text-sm mb-1",children:"Surge Watts (W)"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",value:c.surgeWatts,onChange:t=>d({...c,surgeWatts:t.target.value}),placeholder:"W",className:"p-2 border border-gray-300 rounded-md focus:ring-gridors-primary focus:border-gridors-primary pr-8 w-full",title:"Peak power drawn momentarily on startup"}),e.jsx("span",{className:"absolute inset-y-0 right-0 pr-2 flex items-center text-gray-600 pointer-events-none",children:"W"})]})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"text-gray-700 text-sm mb-1",children:"Hours/day"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",value:c.hours,onChange:t=>d({...c,hours:t.target.value}),placeholder:"Hrs",className:"p-2 border border-gray-300 rounded-md focus:ring-gridors-primary focus:border-gridors-primary pr-8 w-full"}),e.jsx("span",{className:"absolute inset-y-0 right-0 pr-2 flex items-center text-gray-600 pointer-events-none",children:"Hrs"})]})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"text-gray-700 text-sm mb-1",children:"Duty Cycle (0-1)"}),e.jsx("input",{type:"number",value:c.dutyCycle,onChange:t=>d({...c,dutyCycle:t.target.value}),placeholder:"e.g., 0.33",step:"0.01",className:"p-2 border border-gray-300 rounded-md text-sm focus:ring-gridors-primary focus:border-gridors-primary w-full",title:"e.g., 0.33 for 33% active time"})]}),e.jsx("div",{className:"flex justify-end items-end col-span-full sm:col-span-1",children:e.jsxs("button",{onClick:n,className:"p-2 bg-gridors-primary text-white rounded-md hover:bg-gridors-primary-light transition-colors",children:[e.jsx("i",{className:"fas fa-plus"})," Add Appliance"]})})]})})]}),O=({autonomyDays:s,setAutonomyDays:a,solarHours:l,setSolarHours:c,systemVoltage:d,setSystemVoltage:n,inverterEfficiency:t,setInverterEfficiency:i,solarSystemLosses:x,setSolarSystemLosses:p,batteryType:r,setBatteryType:m,tempFactor:u,setTempFactor:y,selectedPanelId:b,setSelectedPanelId:w,selectedBatteryId:_,setSelectedBatteryId:j,solarComponents:N,PRESETS:C,usePreset:E,resetCalculator:S})=>e.jsxs("div",{className:"mb-8 p-6 border border-gray-200 rounded-lg bg-gray-50",children:[e.jsx("h3",{className:"text-2xl font-semibold text-gray-800 mb-4 section-title",children:"0. Load a Preset Scenario"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Choose a predefined setup to quickly estimate your system needs or clear to start fresh."}),e.jsxs("div",{className:"relative inline-block w-full sm:w-1/2 md:w-1/3 mb-8",children:[" ",e.jsxs("select",{onChange:o=>E(o.target.value),className:"block appearance-none w-full bg-white border border-gray-300 text-gray-700 py-3 px-4 pr-8 rounded-md leading-tight focus:outline-none focus:bg-white focus:border-gridors-primary",defaultValue:"",children:[e.jsx("option",{value:"",children:"-- Clear Preset / Start Fresh --"}),Object.keys(C).map(o=>e.jsx("option",{value:o,children:o},o))]}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700",children:e.jsx("svg",{className:"fill-current h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})})})]}),e.jsx("h3",{className:"text-2xl font-semibold text-gray-800 mb-4 section-title",children:"2. System Parameters"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Define your system's operational characteristics for accurate sizing."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"text-gray-700 mb-1",children:"Solar Panel Model:"}),e.jsx("select",{value:b,onChange:o=>w(o.target.value),className:"p-2 border border-gray-300 rounded-md focus:ring-gridors-primary focus:border-gridors-primary",children:N.solarPanels.map(o=>e.jsxs("option",{value:o.id,children:[o.brand," ",o.model," (",o.power_watts,"W)"]},o.id))})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"text-gray-700 mb-1",children:"Battery Model:"}),e.jsx("select",{value:_,onChange:o=>j(o.target.value),className:"p-2 border border-gray-300 rounded-md focus:ring-gridors-primary focus:border-gridors-primary",children:N.batteries.map(o=>e.jsxs("option",{value:o.id,children:[o.brand," ",o.model," (",o.capacity_ah,"Ah ",o.voltage_v,"V ",o.type,")"]},o.id))}),e.jsxs("span",{className:"text-gray-500 text-xs mt-1",title:"Battery type, efficiency, and DoD will update based on selected model.",children:[e.jsx("i",{className:"fas fa-info-circle mr-1"}),"Info from model"]})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsxs("span",{className:"text-gray-700 text-sm mb-1",title:"Enter reduction in battery capacity due to cold temperatures. e.g., 80 for 20% loss at cold temps (0.80 factor).",children:["Temp. Derating Factor (%) ",e.jsx("i",{className:"fas fa-info-circle ml-1 text-gray-400"})]}),e.jsx("input",{type:"number",value:u*100,onChange:o=>y(parseFloat(o.target.value)/100),className:"p-2 border border-gray-300 rounded-md focus:ring-gridors-primary focus:border-gridors-primary"})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"text-gray-700 mb-1",children:"Autonomy (Days without sun):"}),e.jsx("input",{type:"number",value:s,onChange:o=>a(parseFloat(o.target.value)),className:"p-2 border border-gray-300 rounded-md focus:ring-gridors-primary focus:border-gridors-primary"})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"text-gray-700 mb-1",children:"Average Peak Sun Hours/day:"}),e.jsx("input",{type:"number",value:l,onChange:o=>c(parseFloat(o.target.value)),className:"p-2 border border-gray-300 rounded-md focus:ring-gridors-primary focus:border-gridors-primary"})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"text-gray-700 mb-1",children:"System Voltage (V) - from Battery:"}),e.jsx("input",{type:"number",value:d,readOnly:!0,className:"p-2 border border-gray-300 rounded-md bg-gray-100 cursor-not-allowed"}),e.jsxs("span",{className:"text-gray-500 text-xs mt-1",title:"System Voltage is determined by the selected battery model.",children:[e.jsx("i",{className:"fas fa-info-circle mr-1"}),"Read-only"]})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"text-gray-700 mb-1",children:"Inverter Efficiency (%):"}),e.jsx("input",{type:"number",value:t*100,onChange:o=>i(parseFloat(o.target.value)/100),className:"p-2 border border-gray-300 rounded-md focus:ring-gridors-primary focus:border-gridors-primary"})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"text-gray-700 mb-1",children:"Solar System Losses (%):"}),e.jsx("input",{type:"number",value:x*100,onChange:o=>p(parseFloat(o.target.value)/100),className:"p-2 border border-gray-300 rounded-md focus:ring-gridors-primary focus:border-gridors-primary"})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"text-gray-700 mb-1",children:"Battery Efficiency (%) - from Model:"}),e.jsx("input",{type:"number",value:batteryEfficiency*100,readOnly:!0,className:"p-2 border border-gray-300 rounded-md bg-gray-100 cursor-not-allowed"}),e.jsxs("span",{className:"text-gray-500 text-xs mt-1",title:"Efficiency depends on selected battery model.",children:[e.jsx("i",{className:"fas fa-info-circle mr-1"}),"Read-only"]})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"text-gray-700 mb-1",children:"Battery DoD (%) - from Model:"}),e.jsx("input",{type:"number",value:batteryDepthOfDischarge*100,readOnly:!0,className:"p-2 border border-gray-300 rounded-md bg-gray-100 cursor-not-allowed"}),e.jsxs("span",{className:"text-gray-500 text-xs mt-1",title:"Depth of Discharge depends on selected battery model.",children:[e.jsx("i",{className:"fas fa-info-circle mr-1"}),"Read-only"]})]})]}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsx("button",{onClick:()=>dispatch({type:"RESET_CALCULATOR"}),className:"btn btn-secondary px-4 py-2 rounded-md font-bold",children:"Reset All Values"})})]}),H=({totalDailyWh:s,requiredSolarWatts:a,requiredBatteryAh:l,requiredBatteryKWh:c,numBatteries:d,numSolarPanels:n,requiredInverterWatts:t,requiredChargeControllerAmps:i})=>e.jsxs("div",{className:"p-6 border border-gray-200 rounded-lg bg-gridors-light",children:[e.jsx("h3",{className:"text-2xl font-semibold text-gray-800 mb-4 section-title",children:"3. System Sizing Results"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Based on your input, here are the estimated sizes for your off-grid system components."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded-md shadow-sm border border-gray-100 flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-700 font-medium",children:"Total Daily Energy Consumption (Wh):"}),e.jsxs("span",{className:"text-gridors-primary text-xl font-bold",children:[s.toFixed(2)," Wh"]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-md shadow-sm border border-gray-100 flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-700 font-medium",children:"Required Solar Panel Array Size (Watts):"}),e.jsxs("span",{className:"text-gridors-primary text-xl font-bold",children:[a.toFixed(2)," W"]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-md shadow-sm border border-gray-100 flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-700 font-medium",children:"Required Battery Bank Capacity (Ah):"}),e.jsxs("span",{className:"text-gridors-primary text-xl font-bold",children:[l.toFixed(2)," Ah"]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-md shadow-sm border border-gray-100 flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-700 font-medium",children:"Battery Bank Capacity (kWh):"}),e.jsxs("span",{className:"text-gridors-primary text-xl font-bold",children:[c.toFixed(2)," kWh"]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-md shadow-sm border border-gray-100 flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-700 font-medium",children:"Approx. # of 100Ah 12V Batteries:"}),e.jsx("span",{className:"text-gridors-primary text-xl font-bold",children:d})]}),e.jsxs("div",{className:"bg-white p-4 rounded-md shadow-sm border border-gray-100 flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-700 font-medium",children:"Approx. # of 300W Solar Panels:"}),e.jsx("span",{className:"text-gridors-primary text-xl font-bold",children:n})]}),e.jsxs("div",{className:"bg-white p-4 rounded-md shadow-sm border border-gray-100 flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-700 font-medium",children:"Recommended Inverter Size (Watts):"}),e.jsxs("span",{className:"text-gridors-primary text-xl font-bold",children:[t.toFixed(2)," W"]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-md shadow-sm border border-gray-100 flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-700 font-medium",children:"Recommended Charge Controller (Amps):"}),e.jsxs("span",{className:"text-gridors-primary text-xl font-bold",children:[i.toFixed(2)," A"]})]})]})]});let L,T,R;if(typeof window<"u"){const s=await W(()=>import("./chart.BtZhsaeM.js"),[]),a=await W(()=>import("./index.s-9Luwnv.js"),__vite__mapDeps([0,1,2]));L=s.Chart,T=a.Pie,R=a.Bar,L.register(s.ArcElement,s.Tooltip,s.Legend,s.CategoryScale,s.LinearScale,s.BarElement)}const h={solarPanels:[{id:"panel-001",model:"EcoSun 100M",brand:"EcoSol",power_watts:100,voltage_vmp:18.9,current_imp:5.29,voltage_voc:22.8,current_isc:5.67,type:"Monocrystalline",dimensions_mm:"1000x500x35",price_usd_approx:90},{id:"panel-002",model:"PowerVault 300P",brand:"SolarGen",power_watts:300,voltage_vmp:32.5,current_imp:9.23,voltage_voc:39.5,current_isc:9.78,type:"Polycrystalline",dimensions_mm:"1640x992x40",price_usd_approx:250},{id:"panel-003",model:"SunForge 400M Pro",brand:"ResilientEnergy",power_watts:400,voltage_vmp:40.5,current_imp:9.88,voltage_voc:48.6,current_isc:10.35,type:"Monocrystalline",dimensions_mm:"1990x1000x35",price_usd_approx:350},{id:"panel-004",model:"HelioMax 450H",brand:"SunTech",power_watts:450,voltage_vmp:41.2,current_imp:10.92,voltage_voc:49.8,current_isc:11.45,type:"Half-Cut Monocrystalline",dimensions_mm:"2108x1048x35",price_usd_approx:400},{id:"panel-005",model:"BrightWave 250T",brand:"EcoVolt",power_watts:250,voltage_vmp:30.1,current_imp:8.31,voltage_voc:37.4,current_isc:8.85,type:"Thin-Film",dimensions_mm:"1750x850x35",price_usd_approx:200},{id:"panel-006",model:"DualSun 520B",brand:"NextGenSolar",power_watts:520,voltage_vmp:42.8,current_imp:12.15,voltage_voc:51.2,current_isc:12.75,type:"Bifacial Monocrystalline",dimensions_mm:"2256x1133x35",price_usd_approx:480},{id:"panel-007",model:"MiniVolt 50M",brand:"CompactEnergy",power_watts:50,voltage_vmp:17.5,current_imp:2.86,voltage_voc:21,current_isc:3.05,type:"Monocrystalline",dimensions_mm:"700x400x30",price_usd_approx:60},{id:"panel-008",model:"EliteSun 600M Premium",brand:"SolarLux",power_watts:600,voltage_vmp:44,current_imp:13.64,voltage_voc:53,current_isc:14.2,type:"Monocrystalline",dimensions_mm:"2384x1150x35",price_usd_approx:550}],batteries:[{id:"batt-li-001",model:"LithiumCell 100Ah",brand:"LifePower",capacity_ah:100,voltage_v:12,type:"LiFePO4",max_dod:.85,efficiency_roundtrip:.98,cycle_life_at_dod_approx:3e3,dimensions_mm:"330x173x220",weight_kg:12.5,price_usd_approx:350},{id:"batt-li-002",model:"LithiumCell 200Ah",brand:"LifePower",capacity_ah:200,voltage_v:12,type:"LiFePO4",max_dod:.85,efficiency_roundtrip:.98,cycle_life_at_dod_approx:3e3,dimensions_mm:"522x240x220",weight_kg:25,price_usd_approx:650},{id:"batt-la-001",model:"DeepCycle AGM 100Ah",brand:"PowerStore",capacity_ah:100,voltage_v:12,type:"Lead-Acid (AGM)",max_dod:.5,efficiency_roundtrip:.85,cycle_life_at_dod_approx:500,dimensions_mm:"330x170x220",weight_kg:29,price_usd_approx:180},{id:"batt-la-002",model:"DeepCycle Flooded 200Ah",brand:"Everlast",capacity_ah:200,voltage_v:6,type:"Lead-Acid (Flooded)",max_dod:.5,efficiency_roundtrip:.8,cycle_life_at_dod_approx:800,dimensions_mm:"260x180x270",weight_kg:35,price_usd_approx:220},{id:"batt-li-003",model:"PowerCore 150Ah",brand:"VoltMaster",capacity_ah:150,voltage_v:24,type:"LiFePO4",max_dod:.9,efficiency_roundtrip:.97,cycle_life_at_dod_approx:3500,dimensions_mm:"480x200x240",weight_kg:20,price_usd_approx:550},{id:"batt-la-003",model:"EnduraGel 120Ah",brand:"StableEnergy",capacity_ah:120,voltage_v:12,type:"Lead-Acid (Gel)",max_dod:.6,efficiency_roundtrip:.87,cycle_life_at_dod_approx:700,dimensions_mm:"350x175x230",weight_kg:32,price_usd_approx:240},{id:"batt-li-004",model:"HighVolt 100Ah",brand:"EnerSys",capacity_ah:100,voltage_v:48,type:"LiFePO4",max_dod:.9,efficiency_roundtrip:.98,cycle_life_at_dod_approx:4e3,dimensions_mm:"600x250x200",weight_kg:30,price_usd_approx:900},{id:"batt-li-005",model:"LiteCell 50Ah",brand:"PowerLite",capacity_ah:50,voltage_v:12,type:"LiFePO4",max_dod:.85,efficiency_roundtrip:.98,cycle_life_at_dod_approx:3e3,dimensions_mm:"250x150x180",weight_kg:6.5,price_usd_approx:200},{id:"batt-lto-001",model:"TitanPower 80Ah",brand:"FutureCell",capacity_ah:80,voltage_v:24,type:"Lithium Titanate (LTO)",max_dod:.95,efficiency_roundtrip:.99,cycle_life_at_dod_approx:1e4,dimensions_mm:"400x180x200",weight_kg:18,price_usd_approx:1200}]},F=h.solarPanels.length>0&&h.batteries.length>0?{"Tiny Cabin":{appliances:[{id:1,name:"LED Lights",watts:15,hours:8,dutyCycle:1,surgeWatts:0},{id:2,name:"Laptop",watts:60,hours:4,dutyCycle:1,surgeWatts:0},{id:3,name:"Phone Charging",watts:10,hours:6,dutyCycle:1,surgeWatts:0},{id:4,name:"Water Pump (small)",watts:100,hours:.5,dutyCycle:1,surgeWatts:300},{id:5,name:"Comms Radio",watts:5,hours:24,dutyCycle:1,surgeWatts:0}],solarHours:4,autonomyDays:3,systemVoltage:12,batteryType:"Lead-Acid",tempFactor:1.1,selectedPanelId:h.solarPanels[0].id,selectedBatteryId:h.batteries[2].id},"Remote Workshop":{appliances:[{id:1,name:"LED Lights (Shop)",watts:50,hours:6,dutyCycle:1,surgeWatts:0},{id:2,name:"Power Drill (intermittent)",watts:700,hours:.2,dutyCycle:1,surgeWatts:1500},{id:3,name:"Soldering Iron",watts:40,hours:3,dutyCycle:1,surgeWatts:0},{id:4,name:"Small Air Compressor (intermittent)",watts:1e3,hours:.1,dutyCycle:1,surgeWatts:3e3},{id:5,name:"Laptop",watts:60,hours:8,dutyCycle:1,surgeWatts:0}],solarHours:6,autonomyDays:2,systemVoltage:24,batteryType:"LiFePO4",tempFactor:1,selectedPanelId:h.solarPanels[1].id,selectedBatteryId:h.batteries[0].id},"Family Home (Moderate)":{appliances:[{id:1,name:"LED Lights (Home)",watts:100,hours:8,dutyCycle:1,surgeWatts:0},{id:2,name:"Refrigerator",watts:100,hours:24,dutyCycle:.33,surgeWatts:500},{id:3,name:"Freezer",watts:150,hours:24,dutyCycle:.25,surgeWatts:700},{id:4,name:"Microwave (intermittent)",watts:1e3,hours:.05,dutyCycle:1,surgeWatts:1800},{id:5,name:"Washing Machine (intermittent)",watts:500,hours:.5,dutyCycle:1,surgeWatts:1500},{id:6,name:"Laptop/Tablet Charging",watts:150,hours:6,dutyCycle:1,surgeWatts:0},{id:7,name:"Water Pump (house)",watts:500,hours:1,dutyCycle:1,surgeWatts:1500}],solarHours:5,autonomyDays:2,systemVoltage:48,batteryType:"LiFePO4",tempFactor:1,selectedPanelId:h.solarPanels[2].id,selectedBatteryId:h.batteries[1].id}}:{},P=s=>({appliances:[{id:1,name:"LED Lights",watts:10,hours:6,dutyCycle:1,surgeWatts:0},{id:2,name:"Laptop",watts:60,hours:4,dutyCycle:1,surgeWatts:0},{id:3,name:"Mini Fridge",watts:50,hours:24,dutyCycle:.33,surgeWatts:150}],newAppliance:{name:"",watts:"",hours:"",dutyCycle:100,surgeWatts:""},autonomyDays:2,solarHours:5,systemVoltage:12,inverterEfficiency:.9,solarSystemLosses:.2,batteryType:"LiFePO4",tempFactor:1,selectedPanelId:s.solarComponents?.solarPanels?.[0]?.id||null,selectedBatteryId:s.solarComponents?.batteries?.[0]?.id||null,allSolarComponents:s.solarComponents,totalDailyWh:0,totalDailyAh:0,requiredSolarWatts:0,requiredBatteryAh:0,requiredBatteryKWh:0,numBatteries:0,numSolarPanels:0,requiredInverterWatts:0,requiredChargeControllerAmps:0,showWarning:!1,warningMessage:""});function q(s,a){switch(a.type){case"ADD_APPLIANCE":const l=a.payload;return!l.name||isNaN(parseFloat(l.watts))||isNaN(parseFloat(l.hours))?s:{...s,appliances:[...s.appliances,{id:s.appliances.length>0?Math.max(...s.appliances.map(n=>n.id))+1:1,name:l.name,watts:parseFloat(l.watts),hours:parseFloat(l.hours),dutyCycle:parseFloat(l.dutyCycle)/100,surgeWatts:parseFloat(l.surgeWatts)||0}],newAppliance:{name:"",watts:"",hours:"",dutyCycle:100,surgeWatts:""}};case"UPDATE_APPLIANCE":return{...s,appliances:s.appliances.map(n=>n.id===a.payload.id?{...n,[a.payload.field]:a.payload.field==="name"?a.payload.value:a.payload.field==="dutyCycle"?parseFloat(a.payload.value)/100:parseFloat(a.payload.value)}:n)};case"REMOVE_APPLIANCE":return{...s,appliances:s.appliances.filter(n=>n.id!==a.payload.id)};case"SET_NEW_APPLIANCE_FIELD":return{...s,newAppliance:{...s.newAppliance,[a.payload.field]:a.payload.value}};case"SET_PARAMETER":if(a.payload.field==="selectedBatteryId"){const n=s.allSolarComponents?.batteries?.find(t=>t.id===a.payload.value);return{...s,[a.payload.field]:a.payload.value,systemVoltage:n?n.voltage_v:s.systemVoltage,batteryType:n?n.type:s.batteryType}}return{...s,[a.payload.field]:a.payload.isNumber?parseFloat(a.payload.value):a.payload.value};case"SET_RESULTS":return{...s,...a.payload};case"SET_WARNING":return{...s,showWarning:a.payload.show,warningMessage:a.payload.message};case"LOAD_PRESET":const c=a.payload,d=F[c];return d?{...s,appliances:d.appliances.map((n,t)=>({...n,id:t+1})),solarHours:d.solarHours,autonomyDays:d.autonomyDays,systemVoltage:d.systemVoltage,batteryType:d.batteryType,tempFactor:d.tempFactor,selectedPanelId:d.selectedPanelId,selectedBatteryId:d.selectedBatteryId,newAppliance:{name:"",watts:"",hours:"",dutyCycle:100,surgeWatts:""},showWarning:!1,warningMessage:""}:{...P({solarComponents:s.allSolarComponents})};case"RESET_CALCULATOR":return{...P({solarComponents:s.allSolarComponents})};default:return s}}const U=s=>{const[a,l]=v.useReducer(q,void 0,()=>P(s));v.useEffect(()=>{s.solarComponents?.solarPanels?.length>0&&a.selectedPanelId===null&&l({type:"SET_PARAMETER",payload:{field:"selectedPanelId",value:s.solarComponents.solarPanels[0].id}}),s.solarComponents?.batteries?.length>0&&a.selectedBatteryId===null&&l({type:"SET_PARAMETER",payload:{field:"selectedBatteryId",value:s.solarComponents.batteries[0].id}})},[s.solarComponents,a.selectedPanelId,a.selectedBatteryId]),v.useEffect(()=>{const r=s.solarComponents?.batteries?.find(m=>m.id===a.selectedBatteryId);r&&a.systemVoltage!==r.voltage_v&&l({type:"SET_PARAMETER",payload:{field:"systemVoltage",value:r.voltage_v,isNumber:!0}})},[a.selectedBatteryId,a.systemVoltage,s.solarComponents]);const c=v.useCallback(()=>{const r=s.solarComponents?.solarPanels,m=s.solarComponents?.batteries,u=r?.find(g=>g.id===a.selectedPanelId),y=m?.find(g=>g.id===a.selectedBatteryId);if(!u){l({type:"SET_WARNING",payload:{show:!0,message:"Nepavyko rasti pasirinktos saulės panelės. Patikrinkite pasirinkimą arba pasirinkite numatytąją."}}),l({type:"SET_RESULTS",payload:{totalDailyWh:0,requiredSolarWatts:0,requiredBatteryKWh:0,numBatteries:0,numSolarPanels:0,requiredInverterWatts:0,requiredChargeControllerAmps:0}});return}if(!y){l({type:"SET_WARNING",payload:{show:!0,message:"Nepavyko rasti pasirinktos baterijos. Patikrinkite pasirinkimą arba pasirinkite numatytąją."}}),l({type:"SET_RESULTS",payload:{totalDailyWh:0,requiredSolarWatts:0,requiredBatteryKWh:0,numBatteries:0,numSolarPanels:0,requiredInverterWatts:0,requiredChargeControllerAmps:0}});return}a.showWarning&&l({type:"SET_WARNING",payload:{show:!1,message:""}});let b=a.appliances.reduce((g,f)=>g+f.watts*f.hours*f.dutyCycle,0);const w=b/y.voltage_v,_=b*(1+a.solarSystemLosses)/a.solarHours,j=w*a.autonomyDays*a.tempFactor/(y.max_dod*y.efficiency_roundtrip),N=j*y.voltage_v/1e3,C=Math.ceil(j/y.capacity_ah),E=Math.ceil(a.systemVoltage/y.voltage_v),S=C*E,o=Math.ceil(_/u.power_watts),k=a.appliances.reduce((g,f)=>g+f.watts*f.dutyCycle,0),D=Math.max(0,...a.appliances.map(g=>g.surgeWatts||0)),I=Math.max(k,D)/a.inverterEfficiency;o*u.power_watts/a.systemVoltage*1.25,l({type:"SET_RESULTS",payload:{totalDailyWh:b,requiredSolarWatts:_,requiredBatteryKWh:N,numBatteries:S,numSolarPanels:o,requiredInverterWatts:I,requiredChargeControllerAmps}})},[a.appliances,a.autonomyDays,a.solarHours,a.systemVoltage,a.solarSystemLosses,a.tempFactor,a.inverterEfficiency,a.selectedPanelId,a.selectedBatteryId,s.solarComponents,a.showWarning]);v.useEffect(()=>{c()},[c]);const d={labels:a.appliances.map(r=>r.name),datasets:[{data:a.appliances.map(r=>{const m=r.watts*r.hours*r.dutyCycle;return isNaN(m)?0:m}),backgroundColor:["#FF6384","#36A2EB","#FFCE56","#4BC0C0","#9966FF","#FF9F40","#FFCD56"]}]},n={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right"}}},t=s.solarComponents?.solarPanels?.find(r=>r.id===a.selectedPanelId),i=t?a.numSolarPanels*t.power_watts*a.solarHours*(1-a.solarSystemLosses):0,x={labels:["Dienos Suvartojimas","Panelių Gamyba"],datasets:[{label:"Dienos suvartojimas (Wh)",data:[isNaN(a.totalDailyWh)?0:a.totalDailyWh],backgroundColor:"#FF6384"},{label:"Panelių gamyba (Wh)",data:[isNaN(i)?0:i],backgroundColor:"#36A2EB"}]},p={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"}}};return e.jsxs("div",{className:"off-grid-calculator p-4 sm:p-6 bg-white rounded-lg shadow-xl max-w-5xl mx-auto my-10 font-sans",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-6 text-center",children:"Saulės energijos sistemos skaičiuoklė"}),e.jsx("p",{className:"text-gray-700 mb-8 text-center",children:"Suplanuokite savo saulės, akumuliatorių ir rezervinės energijos poreikius."}),e.jsxs("div",{className:"mb-8 p-6 border border-gray-200 rounded-lg bg-gray-50",children:[e.jsx("h3",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"0. Įkelkite išankstinį scenarijų"}),e.jsx("div",{className:"relative inline-block w-full sm:w-1/2 md:w-1/3",children:e.jsxs("select",{onChange:r=>l({type:"LOAD_PRESET",payload:r.target.value}),className:"block appearance-none w-full bg-white border border-gray-300 text-gray-700 py-3 px-4 pr-8 rounded-md",defaultValue:"",children:[e.jsx("option",{value:"",children:"-- Išvalyti / Pradėti iš naujo --"}),Object.keys(F).map(r=>e.jsx("option",{value:r,children:r},r))]})})]}),a.showWarning&&e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-6",role:"alert",children:[e.jsx("strong",{className:"font-bold",children:"Dėmesio!"}),e.jsxs("span",{className:"block sm:inline",children:[" ",a.warningMessage]})]}),e.jsx(V,{appliances:a.appliances,updateAppliance:(r,m,u)=>l({type:"UPDATE_APPLIANCE",payload:{id:r,field:m,value:u}}),removeAppliance:r=>l({type:"REMOVE_APPLIANCE",payload:{id:r}}),newAppliance:a.newAppliance,setNewApplianceField:(r,m)=>l({type:"SET_NEW_APPLIANCE_FIELD",payload:{field:r,value:m}}),addAppliance:()=>l({type:"ADD_APPLIANCE",payload:a.newAppliance})}),e.jsx(O,{...a,setAutonomyDays:r=>l({type:"SET_PARAMETER",payload:{field:"autonomyDays",value:r,isNumber:!0}}),setSolarHours:r=>l({type:"SET_PARAMETER",payload:{field:"solarHours",value:r,isNumber:!0}}),setSystemVoltage:r=>l({type:"SET_PARAMETER",payload:{field:"systemVoltage",value:r,isNumber:!0}}),setInverterEfficiency:r=>l({type:"SET_PARAMETER",payload:{field:"inverterEfficiency",value:r,isNumber:!0}}),setSolarSystemLosses:r=>l({type:"SET_PARAMETER",payload:{field:"solarSystemLosses",value:r,isNumber:!0}}),setTempFactor:r=>l({type:"SET_PARAMETER",payload:{field:"tempFactor",value:r,isNumber:!0}}),setSelectedPanelId:r=>l({type:"SET_PARAMETER",payload:{field:"selectedPanelId",value:r}}),setSelectedBatteryId:r=>l({type:"SET_PARAMETER",payload:{field:"selectedBatteryId",value:r}}),solarComponents:s.solarComponents}),e.jsx(H,{...a}),typeof window<"u"&&e.jsxs("div",{className:"mt-8 p-6 border border-gray-200 rounded-lg bg-gray-50",children:[e.jsx("h3",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"4. Vizualizacijos"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-white p-4 rounded-md shadow-sm border",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-800 mb-4",children:"Energijos suvartojimas pagal įrenginius (Wh/dieną)"}),d.datasets[0].data.some(r=>r>0)?e.jsx("div",{style:{height:"300px"},children:e.jsx(T,{data:d,options:n})}):e.jsx("p",{className:"text-center text-gray-500",children:"Nėra energijos suvartojimo duomenų vizualizavimui."})]}),e.jsxs("div",{className:"bg-white p-4 rounded-md shadow-sm border",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-800 mb-4",children:"Suvartojimas vs. Gamyba (Wh/dieną)"}),x.datasets[0].data[0]>0||x.datasets[1].data[0]>0?e.jsx("div",{style:{height:"300px"},children:e.jsx(R,{data:x,options:p})}):e.jsx("p",{className:"text-center text-gray-500",children:"Nėra energijos gamybos/suvartojimo duomenų vizualizavimui."})]})]})]})]})};export{U as default};
